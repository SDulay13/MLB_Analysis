"0","library(dplyr)"
"0",""
"0","k <- 10"
"0","set.seed(139)"
"0",""
"0","mlb_logit <- normalized_mlb %>%"
"0","  select(""SB"", ""PAge"", ""BatAge"", ""EV"", ""ERA"", ""BB"", ""OPS"", ""HR"", "
"0","         ""RS."", ""E"", ""Rdrs"", ""playoffs"")"
"0","mlb_logit$playoffs <- as.numeric(as.character(mlb_logit$playoffs))"
"0","mlb_logit$fold <- sample(rep(1:k, length.out = nrow(mlb_logit)))"
"0",""
"0","mspe_vals_logit <- numeric(k)"
"0",""
"0","#  k-fold cv"
"0","for (i in 1:k) {"
"0","  train_data_logit <- mlb_logit %>% filter(fold != i)"
"0","  test_data_logit <- mlb_logit %>% filter(fold == i)"
"0","  "
"0","  # fit "
"0","  logit_base <- glm(playoffs ~ SB + PAge + BatAge + EV + ERA + BB + "
"0","                      OPS + HR + RS. + E + Rdrs,"
"0","                    data = train_data_logit, family = ""binomial"")"
"0","  "
"0","  # predict on test set"
"0","  test_data_logit$predicted_prob <- predict(logit_base, newdata = test_data_logit, type = ""response"")"
"0","  "
"0","  "
"0","  test_data_logit$mspe <- (test_data_logit$predicted_prob - test_data_logit$playoffs)^2"
"0","  mspe_vals_logit[i] <- mean(test_data_logit$mspe)"
"0","}"
"0",""
"0","logit_mspe <- sqrt(mean(mspe_vals_logit))"
"0","cat(""Logit Regression MSPE:"", logit_mspe, ""\n"")"
"1","Logit Regression MSPE:"
"1"," "
"1","0.3044582"
"1"," "
"1","
"
